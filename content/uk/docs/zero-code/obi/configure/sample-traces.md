---
title: Налаштування вибірки трейсів OBI OpenTelemetry
linkTitle: Вибірка трейсів
description: Налаштуйте, як вибирати трейси OpenTelemetry.
weight: 70
default_lang_commit: 873e42833f8e17860becdff26de4717194eb11ca
---

OBI приймає стандартні змінні середовища OpenTelemetry для налаштування коефіцієнта вибірки трейсів.

Секція YAML: `otel_traces_export.sampler`

Ви можете налаштувати компонент у секції `otel_traces_export.sampler` вашої YAML конфігурації або за допомогою змінних середовища.

```yaml
otel_traces_export:
  sampler:
    name: 'traceidratio'
    arg: '0.1'
```

| YAML<p>змінна середовища</p>          | Опис                                                                                                                                                                                                      | Тип    | Стандартно              |
| ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ | ----------------------- |
| `name`<p>`OTEL_TRACES_SAMPLER`</p>    | Визначає назву вибірки. Приймає стандартні назви вибірки з [специфікації OpenTelemetry](/docs/languages/sdk-configuration/general/#otel_traces_sampler). Див. [назва вибірки](#sampler-name) для деталей. | string | `parentbased_always_on` |
| `arg`<p>`OTEL_TRACES_SAMPLER_ARG`</p> | Визначає аргумент для вибраної вибірки. Тільки `traceidratio` і `parentbased_traceidratio` вимагають аргумент. Див. [аргумент вибірки](#sampler-argument) для деталей.                                    | string | (unset)                 |

## Назва вибірки {#sampler-name}

Властивість `name` приймає такі стандартні назви вибірки:

- `always_on`: вибирає кожен трейс. Будьте обережні, використовуючи цю вибірку у застосунку зі значним трафіком: новий трейс буде запущений і експортований для кожного запиту
- `always_off`: не вибирає жоден трейс
- `traceidratio`: вибирає певну частку трейсів (вказану властивістю `arg`). Частка повинна бути дійсним значенням між 0 і 1. Наприклад, значення `"0.5"` вибирає 50% трейсів. Частки >= 1 завжди вибираються. Частки < 0 розглядаються як нульові. Щоб врахувати конфігурацію вибірки батьківського трейс, використовуйте вибірку `parentbased_traceidratio`.
- `parentbased_always_on` (стандартно): версія вибірки `always_on` на основі батьків
- `parentbased_always_off`: версія вибірки `always_off` на основі батьків
- `parentbased_traceidratio`: версія вибірки `traceidratio` на основі батьків

Вибірки на основі батьків є складними вибірками, які поводяться по-різному в залежності від батька відрізку трейса. Якщо у відрізка немає батька, використовується кореневий вибірник для прийняття рішення про вибірку. Якщо у відрізка є батько, конфігурація вибірки залежить від вибірки батька.

## Аргумент вибірки {#sampler-argument}

Властивість `arg` визначає аргумент для вибраної вибірки. Тільки `traceidratio` і `parentbased_traceidratio` вимагають аргумент.

В YAML, ви повинні надати це значення як рядок. Навіть якщо значення є числовим, переконайтеся, що ви обгортаєте його в лапки у файлі YAML (наприклад, `arg: "0.25"`).
