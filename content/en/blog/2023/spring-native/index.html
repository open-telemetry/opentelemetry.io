---
title: Observe your Spring Native application with OpenTelemetry instrumentation
linkTitle: OTel Spring Native
date: 2023-11-28
author: >-
  [Jean Bisutti](https://github.com/jeanbisutti) (Microsoft)
---

You may know the [OpenTelemetry Java
agent](https://opentelemetry.io/docs/instrumentation/java/automatic/). However,
Java agents are [not officially
supported]((https://github.com/oracle/graal/issues/1065)) with GraalVM native
images today. This post presents an OpenTelemetry solution to get telemetry data
with Spring Boot native image applications. ## Instrumentation of Spring Boot
native image applications - A history of the last months The OpenTelemetry
contributors have used the existing OpenTelemetry Spring Boot starter to
instrument Spring Boot native image applications with OpenTelemetry without byte
code instrumentation. They have improved the starter in the last months. For
example, they have added the OTLP log export. The OpenTelemetry starter provides
auto-instrumentation for Spring HTTP frameworks. So, by adding the starter
dependency to your project, you will benefit from the instrumentation of HTTP
requests. {{< tabpane text=true >}} {{% tab header="Maven (pom.xml)" lang=Maven
%}}

<dependencies>
  <dependency>
    <groupId>io.opentelemetry.instrumentation</groupId>
    <artifactId>opentelemetry-spring-boot-starter</artifactId>
    <version>{{% param vers.instrumentation %}}-alpha</version>
  </dependency>
</dependencies>
{{% /tab %}} {{% tab header="Gradle (gradle.build)" lang=Gradle %}} dependencies
{
implementation('io.opentelemetry.instrumentation:opentelemetry-spring-boot-starter:{{%
param vers.instrumentation %}}-alpha') } In addition to the starter,
[OpenTelemetry instrumentation
libraries](https://opentelemetry.io/docs/instrumentation/java/manual/) can be
used. The OpenTelemetry contributors have improved the JDBC (database) libraries
and logging instrumentation libraries. For the Logback logging library, the
OpenTelemetry developers have added GraalVM configuration to make the library
work in native mode. Spring Boot native image applications do not support Log4j2
logging library
[https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-with-GraalVM).
They have also worked to reduce the configuration to set up the logging and
database instrumentation with the OpenTelemetry Starter. For example, if your
application does not declare DataSource bean, you enable the database by simply
adding two properties in the application.properties file:
spring.datasource.url=jdbc:otel:h2:mem:db
spring.datasource.driver-class-name=io.opentelemetry.instrumentation.jdbc.OpenTelemetryDriver
Feel free to read the documentation of the OpenTelemetry starter to learn more.
You can also use opentelemetry-java-examples/spring-native to run a Spring Boot
native image application and look at the generated HTTP, log, and database
telemetry data. Note that the OpenTelemetry developers have also added GraalVM
native automatic tests to the OpenTelemetry Java instrumentation project to
detect regressions related to the native mode execution. ##Whatâ€™s next? The
OpenTelemetry contributors expect to be able to configure the logging and the
database instrumentation automatically. Please share your thoughts and
experience about the OpenTelemetry starter and Spring Boot native applications.
