{{ with .Params.canonical_url -}}

<link rel="canonical" href="{{ . }}">

{{- else -}}

  {{ $canonicalURL := .Permalink -}}

  <link rel="canonical" href="{{ $canonicalURL }}">

{{- end -}}
